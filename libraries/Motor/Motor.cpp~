#include <Motor.h>
#include <Arduino.h> 

Motor::Motor(short lMotor, short rMotor){

    LPin = lMotor;
    RPin = rMotor;
    pinMode(LPin, OUTPUT);
    pinMode(RPin, OUTPUT);
}

void Motor::setSpeed(short l, short r){
  //convert the logic-level from 0 ~ 255 to 100 ~ -100
  l = l *(-1);
  if(l > 0){
    l = map(l, 1, 100, 129, 254);
  }
  else if(l < 0){
    l = map(l, -100, -1, 1, 127);
  }
  else l = 128;  
  
  if(r > 0){
    r = map(r, 1, 100, 129, 254);
  }
  else if(r < 0){
    r = map(r, -100, -1, 1, 127);
  }
  else r = 128;  
  //write to PWM-Pin
  analogWrite(LPin, l);
  analogWrite(RPin, r);  
}

void Motor::setSpeedFor(short l, short r, short duration){
    Motor::setSpeed(l, r);
    delay(duration);
    Motor::setSpeed(0, 0);
}

void Motor::setZero(short duration){
  analogWrite(LPin, 128);
  analogWrite(RPin, 128);
  delay(duration); 

}

void Motor::setLeftMotorPin(short l){
    LPin = l;
    pinMode(LPin, OUTPUT);
}

void Motor::setRightMotorPin(short r){
    RPin = r;
    pinMode(RPin, OUTPUT);
}
short Motor::getLeftMotorPin(){
    return LPin;
}
short Motor::getRightMotorPin(){
    return RPin;
}
